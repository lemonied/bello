"use strict";(self.webpackChunkbello=self.webpackChunkbello||[]).push([[625],{2625:function(tt,X,c){c.r(X),c.d(X,{DiffForm:function(){return P},DiffFormConfigContext:function(){return Y},DiffFormConfigProvider:function(){return fe},DiffFormTypes:function(){return I},PassProps:function(){return Xe},StatusCode:function(){return g}});var ae=c(97857),y=c.n(ae),oe=c(13769),E=c.n(oe),i=c(67294),S=c(22150);function O(a){return typeof a=="undefined"||a===null||a===""||Array.isArray(a)&&a.length===0}var s=c(85893),ie=["children"],Y=(0,i.createContext)(null),fe=function(t){var e=t.children,n=E()(t,ie),r=(0,i.useContext)(Y),u=(0,i.useMemo)(function(){return Object.assign({},r,n)},[n,r]);return(0,s.jsx)(Y.Provider,{value:u,children:e})},se=c(9783),M=c.n(se),g=function(a){return a.REMOVE="REMOVE",a.ADD="ADD",a.MODIFY="MODIFY",a.EMPTY="EMPTY",a}({}),I=function(a){return a.SOURCE="_DIFF_FORM_TYPE_SOURCE_",a.TARGET="_DIFF_FORM_TYPE_TARGET_",a}({}),w={"zh-cn":{ADD:"\u65B0\u589E",REMOVE:"\u5220\u9664",MODIFY:"\u4FEE\u6539",EMPTY:"\u7A7A"},en:{ADD:"New",REMOVE:"Remove",MODIFY:"Modified",EMPTY:"Empty"}},le=M()(M()(M()(M()({},g.REMOVE,"#ff4d4f"),g.ADD,"#52c41a"),g.MODIFY,"#faad14"),g.EMPTY,"#d9d9d9"),W=(0,i.createContext)({}),T=function(t){var e=t.children,n=t.value,r=(0,i.useContext)(W),u=(0,i.useMemo)(function(){return Object.assign({},r,n)},[n,r]);return(0,s.jsx)(W.Provider,{value:u,children:e})},z=(0,i.createContext)({}),R=function(t){var e=t.children,n=t.value,r=(0,i.useContext)(z),u=(0,i.useMemo)(function(){return Object.assign({},r,n)},[n,r]);return(0,s.jsx)(z.Provider,{value:u,children:e})},ve=c(64599),ce=c.n(ve),de=c(19632),N=c.n(de),me=c(12444),he=c.n(me),xe=c(72004),ye=c.n(xe),x=c(96486),$=function(){function a(){he()(this,a),M()(this,"state",{}),M()(this,"subscribers",[])}return ye()(a,[{key:"setState",value:function(e){a.updateState(this.state,e)}},{key:"getSnapshots",value:function(){return this.state}},{key:"getSnapshot",value:function(e){var n=e.names,r=e.type;if(n&&r)return this.state[a.join([r].concat(N()(n)))]}},{key:"getUniqueFieldsSnapshots",value:function(e){var n=e.names,r=e.type,u=e.uniqueKey;if(n&&r&&u){var o=(0,x.pickBy)(this.state,function(f,l){return new RegExp("^".concat(a.join([(0,x.escapeRegExp)(a.join([r].concat(N()(n)))),"\\d+",(0,x.escapeRegExp)(a.join(u))]),"$")).test(l)});return(0,x.isEmpty)(o)?void 0:o}}},{key:"getChildSnapshots",value:function(e){var n=e.names,r=e.type;if(n&&r){var u=a.join([r].concat(N()(n))),o=(0,x.pickBy)(this.state,function(f,l){return l.startsWith(u)});return(0,x.isEmpty)(o)?void 0:o}}},{key:"emit",value:function(e){var n=a.join([e.type].concat(N()(e.names)));this.setState(e);var r=ce()(this.subscribers),u;try{for(r.s();!(u=r.n()).done;){var o=u.value;(o.fuzzy&&n.startsWith(o.key)||o.uniqueKey&&new RegExp("^".concat(a.join([(0,x.escapeRegExp)(o.key),"\\d+",(0,x.escapeRegExp)(a.join(o.uniqueKey))]),"$")).test(n)||n===o.key)&&o.callback(e)}}catch(f){r.e(f)}finally{r.f()}}},{key:"on",value:function(e,n){var r=this,u=a.join([n.type].concat(N()(n.names))),o=y()(y()({},n),{},{key:u,callback:e});return this.subscribers.push(o),function(){var f=r.subscribers.indexOf(o);f>-1&&r.subscribers.splice(f,1)}}}],[{key:"join",value:function(e){return e.join(a.keySplit)}},{key:"updateState",value:function(e,n){var r=a.join([n.type].concat(N()(n.names)));return n.remove?delete e[r]:e[r]=n,e}}]),a}();M()($,"keySplit","_DIFF_FORM_STORE_KEY_SPLIT_");var D=function(){return(0,i.useContext)(W)},G=function(){var t=D(),e=t.type;return e===I.SOURCE?I.TARGET:I.SOURCE},Fe=function(t){var e=(0,i.useRef)(t);return e.current=t,(0,i.useCallback)(function(){return e.current.apply(e,arguments)},[])},De=function(t){var e=(0,i.useRef)(),n=(0,i.useRef)(t);return n.current!==t&&(e.current=n.current,n.current=t),e.current},B=function(t,e){var n=(0,i.useRef)(),r=De(e);return(typeof e=="undefined"||!(0,x.isEqual)(r,e))&&(n.current=t()),n.current},H=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],u=e.slice(1),o=Fe(r);return B(function(){return x.debounce.apply(void 0,[o].concat(N()(u)))},[u])},pe=c(5574),q=c.n(pe),k=function(){var t=D(),e=t.statusInfo,n=t.firstStatus,r=(0,i.useState)(!1),u=q()(r,2),o=u[0],f=u[1];(0,i.useEffect)(function(){var v=setTimeout(function(){return f(!0)},350);return function(){return clearTimeout(v)}},[]);var l=(0,i.useMemo)(function(){return n?e:void 0},[n,e]);return o?l:void 0},Ce=c(21532),U=function(){return(0,i.useContext)(Y)},Se=function(){var t,e,n=(0,i.useContext)(Ce.ZP.ConfigContext),r=U(),u=(t=(e=n.locale)===null||e===void 0?void 0:e.locale)!==null&&t!==void 0?t:"en";return(0,i.useCallback)(function(o){var f,l,v=r==null?void 0:r.locale,h=(f=w[u])!==null&&f!==void 0?f:w.en,m=Object.assign({},h,v);return(l=m[o])!==null&&l!==void 0?l:o},[u,r==null?void 0:r.locale])},_=function(){var t=Se(),e=U();return(0,i.useCallback)(function(n){if(n){var r,u;return{code:n,text:t(n),color:(r=e==null||(u=e.color)===null||u===void 0?void 0:u[n])!==null&&r!==void 0?r:le[n]}}},[e==null?void 0:e.color,t])},L=function(){return(0,i.useContext)(z)},Z=function(t){return B(function(){if(typeof t!="undefined")return Array.isArray(t)?t.length?t:void 0:[t]},[t])},b=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return B(function(){if(!e.some(function(u){return typeof u=="undefined"})){var r=x.concat.apply(void 0,e);return r.length?r:void 0}},[e])},ge=function(t){var e=Z(t),n=D(),r=n.fullNamePath;return b(r,e)},ee=function(t){var e=Z(t),n=D(),r=n.anotherFieldName,u=n.uniqueKey;return(0,i.useMemo)(function(){return u&&typeof r=="number"&&typeof(e==null?void 0:e[0])=="number"?[r].concat(N()(e.slice(1))):e},[r,e,u])},J=function(t,e){var n=D(),r=n.store,u=(0,i.useState)(function(){return r==null?void 0:r.getSnapshot({type:t,names:e})}),o=q()(u,2),f=o[0],l=o[1],v=(0,i.useRef)(f),h=H(function(){l(v.current)},300);return(0,i.useEffect)(function(){if(e&&t&&r){v.current=r.getSnapshot({type:t,names:e}),h(),h.flush();var m=r.on(function(d){var F=v.current;v.current=d.remove?void 0:d,h(),F!==v.current&&((0,x.isUndefined)(F)||(0,x.isUndefined)(v.current))&&h.flush()},{names:e,type:t});return function(){m(),h.cancel()}}},[t,e,r,h]),f},nt=function(t){var e=useDiffFormContext(),n=e.type,r=useNextNames(t);return J(n,r)},Pe=function(t){var e=D(),n=e.anotherFullNamePath,r=G(),u=ee(t),o=b(n,u);return J(r,o)},Ie=function(t){var e=D(),n=e.type,r=e.fullNamePath,u=e.uniqueKey,o=b(r,t,u);return J(n,o)},je=function(){var t=D(),e=t.store,n=t.anotherFullNamePath,r=t.uniqueKey,u=G(),o=(0,i.useState)(function(){return e==null?void 0:e.getUniqueFieldsSnapshots({names:n,type:u,uniqueKey:r})}),f=q()(o,2),l=f[0],v=f[1],h=(0,i.useRef)(l),m=H(function(){v(h.current)},300);return(0,i.useEffect)(function(){if(n&&u&&e&&r){h.current=e.getUniqueFieldsSnapshots({names:n,type:u,uniqueKey:r}),m(),m.flush();var d=e.on(function(F){var j=h.current;h.current=j?$.updateState(y()({},j),F):e==null?void 0:e.getUniqueFieldsSnapshots({names:n,type:u,uniqueKey:r}),m(),(0,x.values)(j).length!==(0,x.values)(h.current).length&&m.flush()},{names:n,type:u,uniqueKey:r});return function(){d(),m.cancel()}}},[n,m,e,u,r]),l},Ne=function(t){var e=D(),n=e.store,r=e.anotherFullNamePath,u=b(r,t),o=G(),f=(0,i.useRef)((0,i.useMemo)(function(){return n==null?void 0:n.getChildSnapshots({names:u,type:o})},[])),l=(0,i.useState)(!(0,x.isEmpty)(f.current)),v=q()(l,2),h=v[0],m=v[1],d=H(function(){m(!!f.current)},300);return(0,i.useEffect)(function(){if(u&&o&&n){f.current=n.getChildSnapshots({type:o,names:u}),d(),d.flush();var F=n.on(function(j){var C=f.current;f.current=C?$.updateState(y()({},C),j):n==null?void 0:n.getChildSnapshots({names:u,type:o}),d(),(0,x.values)(C).length!==(0,x.values)(f.current).length&&d.flush()},{names:u,type:o,fuzzy:!0});return function(){F(),d.cancel()}}},[o,u,n,d]),h},Ee=function(t){var e=D(),n=e.uniqueKey,r=e.anotherFullNamePath,u=je(),o=Ie(t),f=Ne(t);return(0,i.useMemo)(function(){if(n&&u&&o&&r){var l;return(l=(0,x.values)(u).find(function(v){return(0,x.isEqual)(v.value,o.value)}))===null||l===void 0?void 0:l.names[r.length]}return f?t:void 0},[n,u,o,r,f,t])},Me=c(68400),Re=c.n(Me),Ae=c(35480),Oe=c(93967),Te=c.n(Oe),te,be=Ae.ZP.div(te||(te=Re()([`
  &.diff-form-mark{
    padding: 8px;
    border-style: dashed;
    border-top: none;
    border-left-width: 1px;
    border-bottom-width: 1px;
    border-right-width: 1px;
    border-color: `,`;
    position: relative;

    .diff-form-mark-divider{
      position: absolute;
      bottom: 100%;
      width: 100%;
      left: 0;
      transform: translate(0, 50%);
      display: flex;
      align-items: center;

      & > span{
        font-size: 12px;
        color: `,`;

        &:first-child{
          flex: 0 0 25%;
        }

        &:last-child {
          flex: 1;
        }

        &:first-child, &:last-child{
          border-top-width: 1px;
          border-top-style: dashed;
          border-color: `,`;
        }
      }
    }
  }
`])),function(a){var t;return(t=a.$status)===null||t===void 0?void 0:t.color},function(a){var t;return(t=a.$status)===null||t===void 0?void 0:t.color},function(a){var t;return(t=a.$status)===null||t===void 0?void 0:t.color}),ne=function(t){var e=t.className,n=t.style,r=t.children,u=k();return(0,s.jsxs)(be,{className:Te()(e,{"diff-form-mark":u}),style:n,$status:u,children:[u?(0,s.jsxs)("div",{className:"diff-form-mark-divider",children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{children:u==null?void 0:u.text}),(0,s.jsx)("span",{})]}):null,r]})},Ke=["children","name","noStatus"],Ue=["children","noStatus"],re=i.createContext(null),Le=function(){return i.useContext(re)},Ze=function(t){var e=t.children,n=t.name,r=t.noStatus,u=E()(t,Ke),o=D(),f=o.type,l=o.store,v=o.statusInfo,h=o.firstStatus,m=U(),d=Pe(n),F=_(),j=Z(n),C=ge(n),A=(0,i.useRef)(l);A.current=l;var V=(0,i.useMemo)(function(){if(f){var p=u.value,K=d==null?void 0:d.value,et=function(){if(O(p)&&!O(K))return f===I.SOURCE?g.EMPTY:g.REMOVE;if(!O(p)&&O(K))return f===I.SOURCE?g.REMOVE:g.ADD;if(!O(p)&&!O(K)&&!(0,x.isEqual)(p,K))return g.MODIFY}();return F(et)}},[d==null?void 0:d.value,u.value,f,F]),we=(0,i.useMemo)(function(){return{statusInfo:V!=null?V:v,firstStatus:!h&&!v&&!!V}},[h,V,v]),_e=(0,i.useMemo)(function(){var p;return(p=m==null?void 0:m.wrapper)!==null&&p!==void 0?p:ne},[m==null?void 0:m.wrapper]);return(0,i.useEffect)(function(){if(C&&f){var p,K=u.value;(p=A.current)===null||p===void 0||p.emit({type:f,names:C,value:K})}},[u.value,C,f]),(0,i.useEffect)(function(){if(f&&C)return function(){var p;return(p=A.current)===null||p===void 0?void 0:p.emit({type:f,names:C,remove:!0})}},[C,f]),(0,s.jsx)(T,{value:we,children:(0,s.jsx)(re.Provider,{value:{name:j,fullName:C,value:u.value,anotherValue:v||d==null?void 0:d.value},children:r?(0,i.cloneElement)(e,u):(0,s.jsx)(_e,{children:(0,i.cloneElement)(e,u)})})})},Q=function(t){var e=t.children,n=t.noStatus,r=E()(t,Ue),u=D(),o=Z(t.name);return typeof u.type!="undefined"&&o&&(0,i.isValidElement)(e)?(0,s.jsx)(S.Z.Item,y()(y()({},r),{},{children:(0,s.jsx)(Ze,{name:r.name,noStatus:r.noStyle||n,children:e})})):(0,s.jsx)(S.Z.Item,y()(y()({},r),{},{children:e}))};Q.useStatus=S.Z.Item.useStatus,Q.useDiffValue=Le;var Ve=["uniqueKey"],Ye=["uniqueKey"],$e=function(t){var e=t.uniqueKey,n=E()(t,Ve),r=D(),u=r.anotherFullNamePath,o=L(),f=o.namePaths,l=ee(n.name),v=b(u,l),h=Z(e),m=(0,i.useMemo)(function(){return{fullNamePath:f,anotherFullNamePath:v,uniqueKey:h}},[f,v,h]);return(0,s.jsx)(T,{value:m,children:(0,s.jsx)(S.Z.List,y()({},n))})},qe=function(t){var e=t.uniqueKey,n=E()(t,Ye),r=D(),u=L(),o=u.namePaths,f=b(o,t.name),l=(0,i.useMemo)(function(){return{namePaths:f}},[f]);return typeof r.type!="undefined"?(0,s.jsx)(R,{value:l,children:(0,s.jsx)($e,y()(y()({},n),{},{uniqueKey:e}))}):(0,s.jsx)(R,{value:l,children:(0,s.jsx)(S.Z.List,y()({},n))})},We=function(t){var e=t.children,n=t.noStatus,r=L(),u=r.fieldName,o=Ee(u),f=D(),l=f.statusInfo,v=f.type,h=f.firstStatus,m=_(),d=U(),F=(0,i.useMemo)(function(){if(l)return l;if(typeof o!="number")return v===I.SOURCE?m(g.REMOVE):m(g.ADD)},[o,l,v,m]),j=(0,i.useMemo)(function(){return{fieldName:u,anotherFieldName:o,statusInfo:F,firstStatus:!h&&!l&&!!F}},[u,h,o,F,l]),C=(0,i.useMemo)(function(){var A;return(A=d==null?void 0:d.wrapper)!==null&&A!==void 0?A:ne},[d==null?void 0:d.wrapper]);return(0,s.jsx)(T,{value:j,children:n?e:(0,s.jsx)(C,{children:e})})},ze=function(t){var e=D(),n=(0,i.useMemo)(function(){return{fieldName:t.fieldName}},[t.fieldName]);return typeof e.type!="undefined"?(0,s.jsx)(R,{value:n,children:(0,s.jsx)(We,y()({},t))}):(0,s.jsx)(R,{value:n,children:t.children})},Ge=function(t){var e=t.children,n=L();return e(n)},Be=c(71230),ue=c(15746),He=function(t){var e=t.source,n=t.target;return(0,s.jsxs)(Be.Z,{gutter:[8,8],children:[(0,s.jsx)(ue.Z,{span:24,lg:12,children:e}),(0,s.jsx)(ue.Z,{span:24,lg:12,children:n})]})},ke=function(t){var e=t.children,n=k();return e(n)},Je=["diff"],P=function(t){var e=t.diff,n=E()(t,Je),r=U(),u=(0,i.useMemo)(function(){var F={layout:n.layout,component:n.component,name:"source"};if(e===!0)return F;if(e)return y()(y()({},F),e)},[e,n.layout,n.component]),o=(0,i.useMemo)(function(){return y()({name:u?"target":void 0},n)},[n,u]),f=(0,i.useMemo)(function(){return{store:new $,fullNamePath:[],anotherFullNamePath:[]}},[]),l=(0,i.useMemo)(function(){return{type:I.SOURCE}},[]),v=(0,i.useMemo)(function(){return{type:I.TARGET}},[]),h=(0,i.useMemo)(function(){return{type:l.type,name:u==null?void 0:u.name,disabled:u==null?void 0:u.disabled,namePaths:[]}},[u==null?void 0:u.disabled,u==null?void 0:u.name,l.type]),m=(0,i.useMemo)(function(){return{type:v.type,name:o==null?void 0:o.name,disabled:o==null?void 0:o.disabled,namePaths:[]}},[o==null?void 0:o.disabled,o==null?void 0:o.name,v.type]),d=(0,i.useMemo)(function(){var F;return(F=r==null?void 0:r.component)!==null&&F!==void 0?F:He},[r==null?void 0:r.component]);return u?(0,s.jsx)(T,{value:f,children:(0,s.jsx)(d,{source:(0,s.jsx)(R,{value:h,children:(0,s.jsx)(T,{value:l,children:(0,s.jsx)(S.Z,y()(y()({},u),{},{children:o.children}))})}),target:(0,s.jsx)(R,{value:m,children:(0,s.jsx)(T,{value:v,children:(0,s.jsx)(S.Z,y()({},o))})})})}):(0,s.jsx)(R,{value:m,children:(0,s.jsx)(S.Z,y()({},o))})};P.Item=Q,P.List=qe,P.ListItem=ze,P.ErrorList=S.Z.ErrorList,P.Info=Ge,P.DiffStatus=ke,P.useForm=S.Z.useForm,P.useFormInstance=S.Z.useFormInstance,P.useWatch=S.Z.useWatch,P.useDiffFormInfo=L,P.useDiffFormStatus=k;var Qe=["children"],Xe=function(t){var e=t.children,n=E()(t,Qe);return e(n)}}}]);
