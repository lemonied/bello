(self.webpackChunkbello=self.webpackChunkbello||[]).push([[433],{51566:function(Y,j,u){"use strict";u.r(j);var N=u(67294),d=u(31081),W=u(52975),D=u(71230),o=u(15746),R=u(56881),K=u(18404),E=u(17211),v=u(49191),g=u(79855),O=u(24193),s=u(85893),V=function(){var L=d.Diform.useDiformInfo(),_=L.fieldName;return(0,s.jsx)(W.Z,{title:"\u5BB6\u957F",size:"small",bordered:!1,bodyStyle:{background:"#f3f3f3"},headStyle:{background:"#f3f3f3"},children:(0,s.jsx)(d.Diform.List,{name:[_,"parents"],children:function(C,Z){var T=Z.add,p=Z.remove;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(D.Z,{gutter:[0,16],children:[C.map(function(A){return(0,s.jsx)(o.Z,{span:24,children:(0,s.jsx)(d.Diform.ListItem,{fieldName:A.name,children:(0,s.jsxs)(D.Z,{gutter:8,align:"middle",children:[(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[A.name,"name"],label:"\u59D3\u540D",rules:[{required:!0,message:"\u5FC5\u586B\u9879"}],style:{marginBottom:0},children:(0,s.jsx)(R.Z,{})})}),(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[A.name,"relation"],label:"\u5173\u7CFB",style:{marginBottom:0},children:(0,s.jsx)(R.Z,{})})}),(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[A.name,"height"],label:"\u624B\u673A\u53F7",style:{marginBottom:0},children:(0,s.jsx)(R.Z,{})})}),(0,s.jsx)(o.Z,{style:{paddingTop:26},children:(0,s.jsx)(K.Z.Link,{type:"danger",onClick:function(){return p(A.name)},children:(0,s.jsx)(g.Z,{})})})]})})},A.key)}),(0,s.jsx)(o.Z,{span:24,children:(0,s.jsx)(E.ZP,{block:!0,icon:(0,s.jsx)(O.Z,{}),onClick:function(){return T()},size:"small",children:"\u6DFB\u52A0\u5BB6\u957F"})})]})})}})})},G=function(){var L=d.Diform.useFormInstance();return(0,s.jsx)(W.Z,{title:"\u5B66\u751F\u540D\u5355",size:"small",children:(0,s.jsx)(d.Diform.List,{name:"students",uniqueKey:"name",children:function(I,C){var Z=C.add,T=C.remove;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(D.Z,{gutter:[0,16],children:[I.map(function(p){return(0,s.jsx)(o.Z,{span:24,children:(0,s.jsx)(d.Diform.ListItem,{fieldName:p.name,children:(0,s.jsxs)(D.Z,{gutter:[8,8],align:"middle",children:[(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[p.name,"name"],label:"\u59D3\u540D",style:{marginBottom:0},rules:[{required:!0,message:"\u5FC5\u586B\u9879"},{validator:function(F,X){var k=L.getFieldValue(["students"])||[];return k.some(function(H,q){return q!==p.name&&(H==null?void 0:H.name)===X})?Promise.reject(new Error("\u59D3\u540D\u91CD\u590D")):Promise.resolve()}}],children:(0,s.jsx)(R.Z,{})})}),(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[p.name,"age"],label:"\u5E74\u9F84",style:{marginBottom:0},children:(0,s.jsx)(v.Z,{style:{width:"100%"}})})}),(0,s.jsx)(o.Z,{span:7,children:(0,s.jsx)(d.Diform.Item,{name:[p.name,"height"],label:"\u8EAB\u9AD8",style:{marginBottom:0},children:(0,s.jsx)(v.Z,{style:{width:"100%"},addonAfter:"cm"})})}),(0,s.jsx)(o.Z,{style:{paddingTop:26},children:(0,s.jsx)(K.Z.Link,{type:"danger",onClick:function(){return T(p.name)},children:(0,s.jsx)(g.Z,{})})}),(0,s.jsx)(o.Z,{span:24,children:(0,s.jsx)(V,{})})]})})},p.key)}),(0,s.jsx)(o.Z,{span:24,children:(0,s.jsx)(E.ZP,{block:!0,icon:(0,s.jsx)(O.Z,{}),onClick:function(){return Z()},children:"\u6DFB\u52A0\u5B66\u751F"})})]})})}})})};j.default=function(){return(0,s.jsxs)(d.Diform,{diff:{initialValues:{clazz:"\u4E09\u5E74\u4E8C\u73ED"}},layout:"vertical",initialValues:{clazz:"\u4E09\u5E742\u73ED"},children:[(0,s.jsx)(d.Diform.Item,{name:"clazz",label:"\u73ED\u7EA7",rules:[{required:!0}],children:(0,s.jsx)(R.Z,{})}),(0,s.jsx)(G,{})]})}},63241:function(Y,j,u){"use strict";u.r(j);var N=u(5574),d=u.n(N),W=u(67294),D=u(31081),o=u(65335),R=u(71230),K=u(15746),E=u(56881),v=u(85893);j.default=function(){var g=D.Diform.useForm(),O=d()(g,1),s=O[0];return(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(D.Diform,{form:s,layout:"vertical",diff:{initialValues:{products:[{name:"iphone 15 pro"}]}},initialValues:{products:[{name:"iphone 15 pro max"}]},children:(0,v.jsx)(D.Diform.List,{name:["products"],uniqueKey:["name"],children:function(G,m){var L=m.add,_=m.remove;return(0,v.jsx)(o.Z,{type:"editable-card",onEdit:function(C,Z){Z==="add"?L():_(Number(C))},items:G.map(function(I){return{label:(0,v.jsx)(D.Diform.ListItem,{fieldName:I.name,noStatus:!0,children:(0,v.jsx)(D.PassProps,{children:function(Z){var T=Z.statusInfo;return(0,v.jsx)(D.Diform.Item,{noStatus:!0,noStyle:!0,name:[I.name,"name"],children:(0,v.jsx)(D.PassProps,{children:function(A){return(0,v.jsx)("span",{style:{color:T==null?void 0:T.color},children:A.value})}})})}})}),key:"".concat(I.name),children:(0,v.jsx)(D.Diform.ListItem,{fieldName:I.name,children:(0,v.jsx)(R.Z,{gutter:8,children:(0,v.jsx)(K.Z,{span:8,children:(0,v.jsx)(D.Diform.Item,{name:[I.name,"name"],children:(0,v.jsx)(E.Z,{})})})})},I.key)}})})}})})})}},43997:function(Y,j,u){"use strict";u.d(j,{y:function(){return U}});var N=u(97857),d=u.n(N),W=u(13769),D=u.n(W),o=u(67294),R=u(71230),K=u(15746),E=u(48413),v=u(96486),g={REMOVE:{code:"REMOVE",color:"#ff4d4f",text:"\u5220\u9664"},ADD:{code:"ADD",color:"#52c41a",text:"\u65B0\u589E"},MODIFY:{code:"MODIFY",color:"#faad14",text:"\u4FEE\u6539"},EMPTY:{code:"EMPTY",color:"#d9d9d9",text:"\u7A7A"}},O=function(l){return l.SOURCE="_DIFORM_TYPE_SOURCE_",l.TARGET="_DIFORM_TYPE_TARGET_",l}({});function s(l){return typeof l=="undefined"||l===null||l===""}function V(l,n){return s(l)&&s(n)?!0:(0,v.isEqual)(l,n)}var G=function(n,e,t){if(s(n)&&!s(e))return t===O.SOURCE?g.EMPTY:g.REMOVE;if(!s(n)&&s(e))return t===O.SOURCE?g.REMOVE:g.ADD;if(!V(n,e))return g.MODIFY},m=u(85893),L=(0,o.createContext)({}),_=function(n){var e=n.children,t=n.value,r=(0,o.useContext)(L),a=(0,o.useMemo)(function(){return Object.assign({},r,t)},[t,r]);return(0,m.jsx)(L.Provider,{value:a,children:e})},I=(0,o.createContext)({}),C=function(n){var e=n.children,t=n.value,r=(0,o.useContext)(I),a=(0,o.useMemo)(function(){return Object.assign({},r,t)},[t,r]);return(0,m.jsx)(I.Provider,{value:a,children:e})},Z=u(84820),T=u(96695),p=u.n(T),A=u(19632),F=u.n(A),X=u(12444),k=u.n(X),H=u(72004),q=u.n(H),de=u(9783),w=u.n(de),$=function(){function l(){k()(this,l),w()(this,"state",{}),w()(this,"subscribers",[])}return q()(l,[{key:"setState",value:function(e){l.updateState(this.state,e)}},{key:"getSnapshots",value:function(){return this.state}},{key:"getSnapshot",value:function(e){var t=e.names,r=e.type;if(t&&r)return this.state[[r].concat(F()(t)).join(l.keySplit)]}},{key:"getUniqueFieldsSnapshots",value:function(e){var t=e.names,r=e.type,a=e.uniqueKey;if(t&&r&&a)return(0,v.pickBy)(this.state,function(i,f){return new RegExp("^".concat(l.join([l.join([r].concat(F()(t))),"\\d",l.join(a)]),"$")).test(f)})}},{key:"getChildSnapshots",value:function(e){var t=e.names,r=e.type;if(t&&r){var a=l.join([r].concat(F()(t)));return(0,v.pickBy)(this.state,function(i,f){return f.startsWith(a)})}}},{key:"emit",value:function(e){var t=l.join([e.type].concat(F()(e.names))),r=this.state[t];this.setState(e);var a=p()(this.subscribers),i;try{for(a.s();!(i=a.n()).done;){var f=i.value;f.onlyValue&&!e.remove&&r&&V(e.value,r.value)||(f.fuzzy&&t.startsWith(f.key)||f.uniqueKey&&new RegExp("^".concat(l.join([(0,v.escapeRegExp)(f.key),"\\d",(0,v.escapeRegExp)(l.join(f.uniqueKey))]),"$")).test(t)||t===f.key)&&f.callback(e)}}catch(c){a.e(c)}finally{a.f()}}},{key:"on",value:function(e,t){var r=this,a=[t.type].concat(F()(t.names)).join(l.keySplit),i=d()(d()({},t),{},{key:a,callback:e});return this.subscribers.push(i),function(){var f=r.subscribers.indexOf(i);f>-1&&r.subscribers.splice(f,1)}}}],[{key:"join",value:function(e){return e.join(l.keySplit)}},{key:"updateState",value:function(e,t){var r=[t.type].concat(F()(t.names)).join(l.keySplit);return t.remove?delete e[r]:e[r]=t,e}}]),l}();w()($,"keySplit","_DIFORM_STORE_KEY_SPLIT_");var P=function(){return(0,o.useContext)(L)},ee=function(){var n=P(),e=n.type;return e===O.SOURCE?O.TARGET:O.SOURCE},fe=function(n){var e=(0,o.useRef)(n);return e.current=n,(0,o.useCallback)(function(){return e.current.apply(e,arguments)},[])},me=function(n){var e=(0,o.useRef)(),t=(0,o.useRef)(n);return t.current!==n&&(e.current=t.current,t.current=n),e.current},te=function(n,e){var t=(0,o.useRef)(),r=me(e);return(typeof e=="undefined"||!(0,v.isEqual)(r,e))&&(t.current=n()),t.current},ne=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];var r=e[0],a=e.slice(1),i=fe(r);return te(function(){return v.debounce.apply(void 0,[i].concat(F()(a)))},[a])},J=function(){return(0,o.useContext)(I)},Q=function(n){return te(function(){if(typeof n!="undefined")return Array.isArray(n)?n.length?n:void 0:[n]},[n])},ce=u(5574),re=u.n(ce),z=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return te(function(){if(!e.some(function(a){return typeof a=="undefined"})){var r=v.concat.apply(void 0,e);return r.length?r:void 0}},[e])},ve=function(n){var e=Q(n),t=P(),r=t.fullNamePath;return z(r,e)},se=function(n){var e=Q(n),t=P(),r=t.anotherFieldName,a=t.uniqueKey;return(0,o.useMemo)(function(){return a&&typeof r=="number"&&typeof(e==null?void 0:e[0])=="number"?[r].concat(F()(e.slice(1))):e},[r,e,a])},ae=function(n,e){var t=P(),r=t.store,a=(0,o.useState)(function(){return r==null?void 0:r.getSnapshot({type:n,names:e})}),i=re()(a,2),f=i[0],c=i[1],y=ne(function(h){c(h)},300);return(0,o.useEffect)(function(){if(e&&n&&r){y(r.getSnapshot({type:n,names:e}));var h=r.on(function(x){y(x.remove?void 0:x)},{names:e,type:n,onlyValue:!0});return function(){h(),y.cancel()}}},[n,e,r,y]),f},_e=function(n){var e=useDiformContext(),t=e.type,r=useNextNames(n);return ae(t,r)},he=function(n){var e=P(),t=e.anotherFullNamePath,r=ee(),a=se(n),i=z(t,a);return ae(r,i)},xe=function(n){var e=P(),t=e.type,r=e.fullNamePath,a=e.uniqueKey,i=z(r,n,a);return ae(t,i)},De=function(){var n=P(),e=n.store,t=n.anotherFullNamePath,r=n.uniqueKey,a=ee(),i=(0,o.useState)(function(){return e==null?void 0:e.getUniqueFieldsSnapshots({names:t,type:a,uniqueKey:r})}),f=re()(i,2),c=f[0],y=f[1],h=(0,o.useRef)(c),x=ne(function(){y(h.current)},300);return(0,o.useEffect)(function(){if(t&&a&&e&&r){h.current=e.getUniqueFieldsSnapshots({names:t,type:a,uniqueKey:r}),x();var M=e.on(function(S){h.current=h.current?$.updateState(d()({},h.current),S):e==null?void 0:e.getUniqueFieldsSnapshots({names:t,type:a,uniqueKey:r}),x()},{names:t,type:a,uniqueKey:r,onlyValue:!0});return function(){M(),x.cancel()}}},[t,x,e,a,r]),c},ye=function(n){var e=P(),t=e.store,r=e.anotherFullNamePath,a=z(r,n),i=ee(),f=(0,o.useRef)((0,o.useMemo)(function(){return t==null?void 0:t.getChildSnapshots({names:a,type:i})},[])),c=(0,o.useState)(!(0,v.isEmpty)(f.current)),y=re()(c,2),h=y[0],x=y[1],M=ne(function(){x(!(0,v.isEmpty)(f.current))},300);return(0,o.useEffect)(function(){if(a&&i&&t){f.current=t.getChildSnapshots({type:i,names:a}),M();var S=t.on(function(b){f.current=f.current?$.updateState(d()({},f.current),b):t==null?void 0:t.getChildSnapshots({names:a,type:i}),M()},{names:a,type:i,onlyValue:!0,fuzzy:!0});return function(){S(),M.cancel()}}},[i,a,t,M]),h},Ee=function(n){var e=P(),t=e.uniqueKey,r=e.anotherFullNamePath,a=De(),i=xe(n),f=ye(n);return(0,o.useMemo)(function(){if(t&&a&&i&&r){var c;return(c=(0,v.values)(a).find(function(y){return V(y.value,i.value)}))===null||c===void 0?void 0:c.names[r.length]}return f?n:void 0},[t,a,i,r,f,n])},Pe=u(93967),je=u.n(Pe),ie=function(n){var e=n.className,t=n.style,r=n.children,a=P(),i=a.statusInfo,f=a.firstStatus,c=f?i:null;return(0,m.jsxs)("div",{className:je()(e,{"bello-diform-mark":c}),style:d()({borderColor:c==null?void 0:c.color},t),children:[c?(0,m.jsxs)("div",{className:"bello-diform-mark-divider",children:[(0,m.jsx)("span",{style:{borderColor:c.color}}),(0,m.jsx)("span",{style:{color:c.color},children:i==null?void 0:i.text}),(0,m.jsx)("span",{style:{borderColor:c.color}})]}):null,r]})},Ce=["children","name"],Ie=["children","noStatus"],Me=function(n){var e=n.children,t=n.name,r=D()(n,Ce),a=P(),i=a.type,f=a.store,c=a.statusInfo,y=a.firstStatus,h=he(t),x=ve(t),M=(0,o.useRef)(f);M.current=f;var S=(0,o.useMemo)(function(){if(i){var B=r.value,oe=h==null?void 0:h.value;return G(B,oe,i)}},[h==null?void 0:h.value,r.value,i]),b=(0,o.useMemo)(function(){return{statusInfo:S!=null?S:c,firstStatus:!y&&!c&&!!S}},[y,S,c]),ue=(0,o.useMemo)(function(){return d()(d()({},r),{},{statusInfo:b.firstStatus?b.statusInfo:void 0})},[r,b.statusInfo,b.firstStatus]);return(0,o.useEffect)(function(){if(x&&i){var B,oe=r.value;(B=M.current)===null||B===void 0||B.emit({type:i,names:x,value:oe,statusInfo:S})}},[r.value,x,S,i]),(0,o.useEffect)(function(){if(i&&x)return function(){var B;return(B=M.current)===null||B===void 0?void 0:B.emit({type:i,names:x,remove:!0})}},[x,i]),(0,m.jsx)(_,{value:b,children:ue.noStatus?(0,o.cloneElement)(e,ue):(0,m.jsx)(ie,{children:(0,o.cloneElement)(e,ue)})})},le=function(n){var e=n.children,t=n.noStatus,r=D()(n,Ie),a=P(),i=Q(n.name);return typeof a.type!="undefined"&&i&&(0,o.isValidElement)(e)?(0,m.jsx)(E.Z.Item,d()(d()({},r),{},{children:(0,m.jsx)(Me,{name:r.name,noStatus:t,children:e})})):(0,m.jsx)(E.Z.Item,d()(d()({},r),{},{children:e}))};le.useStatus=E.Z.Item.useStatus;var Se=["uniqueKey"],Oe=["uniqueKey"],pe=function(n){var e=n.uniqueKey,t=D()(n,Se),r=P(),a=r.anotherFullNamePath,i=J(),f=i.namePaths,c=se(t.name),y=z(a,c),h=Q(e),x=(0,o.useMemo)(function(){return{fullNamePath:f,anotherFullNamePath:y,uniqueKey:h}},[f,y,h]);return(0,m.jsx)(_,{value:x,children:(0,m.jsx)(E.Z.List,d()({},t))})},Ae=function(n){var e=n.uniqueKey,t=D()(n,Oe),r=P(),a=J(),i=a.namePaths,f=z(i,n.name),c=(0,o.useMemo)(function(){return{namePaths:f}},[f]);return typeof r.type!="undefined"?(0,m.jsx)(C,{value:c,children:(0,m.jsx)(pe,d()(d()({},t),{},{uniqueKey:e}))}):(0,m.jsx)(C,{value:c,children:(0,m.jsx)(E.Z.List,d()({},t))})},Ne=function(n){var e=n.children,t=n.noStatus,r=J(),a=r.fieldName,i=Ee(a),f=P(),c=f.statusInfo,y=f.type,h=f.firstStatus,x=(0,o.useMemo)(function(){if(c)return c;if(typeof i!="number")return y===O.SOURCE?g.REMOVE:g.ADD},[i,c,y]),M=(0,o.useMemo)(function(){return{fieldName:a,anotherFieldName:i,statusInfo:x,firstStatus:!h&&!c&&!!x}},[a,h,i,x,c]),S=(0,o.useMemo)(function(){return(0,o.isValidElement)(e)?(0,o.cloneElement)(e,{statusInfo:M.statusInfo}):e},[e,M.statusInfo]);return(0,m.jsx)(_,{value:M,children:t?S:(0,m.jsx)(ie,{children:S})})},Re=function(n){var e=P(),t=(0,o.useMemo)(function(){return{fieldName:n.fieldName}},[n.fieldName]);return typeof e.type!="undefined"?(0,m.jsx)(C,{value:t,children:(0,m.jsx)(Ne,d()({},n))}):(0,m.jsx)(C,{value:t,children:n.children})},ge=["diff"],U=function(n){var e=n.diff,t=D()(n,ge),r=(0,o.useMemo)(function(){var x={layout:t.layout,name:"source"};if(e===!0)return x;if(e)return d()(d()({},x),e)},[e,t.layout]),a=(0,o.useMemo)(function(){return d()({name:r?"target":void 0},t)},[t,r]),i=(0,o.useMemo)(function(){return{store:new $,fullNamePath:[],anotherFullNamePath:[]}},[]),f=(0,o.useMemo)(function(){return{type:O.SOURCE}},[]),c=(0,o.useMemo)(function(){return{type:O.TARGET}},[]),y=(0,o.useMemo)(function(){return{name:r==null?void 0:r.name,disabled:r==null?void 0:r.disabled,namePaths:[]}},[r==null?void 0:r.disabled,r==null?void 0:r.name]),h=(0,o.useMemo)(function(){return{name:a==null?void 0:a.name,disabled:a==null?void 0:a.disabled,namePaths:[]}},[a==null?void 0:a.disabled,a==null?void 0:a.name]);return r?(0,m.jsx)(_,{value:i,children:(0,m.jsxs)(R.Z,{gutter:8,children:[(0,m.jsx)(K.Z,{span:12,children:(0,m.jsx)(C,{value:y,children:(0,m.jsx)(_,{value:f,children:(0,m.jsx)(E.Z,d()(d()({},r),{},{children:a.children}))})})}),(0,m.jsx)(K.Z,{span:12,children:(0,m.jsx)(C,{value:h,children:(0,m.jsx)(_,{value:c,children:(0,m.jsx)(E.Z,d()({},a))})})})]})}):(0,m.jsx)(C,{value:h,children:(0,m.jsx)(E.Z,d()({},a))})};U.Item=le,U.List=Ae,U.ListItem=Re,U.ErrorList=E.Z.ErrorList,U.useForm=E.Z.useForm,U.useFormInstance=E.Z.useFormInstance,U.useWatch=E.Z.useWatch,U.useDiformInfo=J},7481:function(Y,j,u){"use strict";u.d(j,{Diform:function(){return N.y}});var N=u(43997),d=u(84820),W=u.n(d);u.o(d,"PassProps")&&u.d(j,{PassProps:function(){return d.PassProps}})},84820:function(){},63170:function(Y,j,u){"use strict";u.d(j,{I:function(){return D}});var N=u(13769),d=u.n(N),W=["children"],D=function(R){var K=R.children,E=d()(R,W);return K(E)}},31081:function(Y,j,u){"use strict";u.d(j,{Diform:function(){return N.Diform},PassProps:function(){return d.I}});var N=u(7481);u.o(N,"PassProps")&&u.d(j,{PassProps:function(){return N.PassProps}});var d=u(63170)}}]);
